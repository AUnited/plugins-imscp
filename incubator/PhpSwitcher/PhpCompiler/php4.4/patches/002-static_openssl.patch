--- a/acinclude.m4
+++ b/acinclude.m4
@@ -1801,26 +1801,25 @@ AC_DEFUN([PHP_SETUP_OPENSSL],[
     CPPFLAGS=$old_CPPFLAGS
 
     PHP_ADD_INCLUDE($OPENSSL_INCDIR)
-  
-    PHP_CHECK_LIBRARY(crypto, CRYPTO_free, [
-      PHP_ADD_LIBRARY(crypto,,$1)
-    ],[
-      AC_MSG_ERROR([libcrypto not found!])
+
+    PHP_CHECK_LIBRARY(:libcrypto.a, CRYPTO_free, [:],[  
+      AC_MSG_ERROR([static libcrypto not found!])
     ],[
       -L$OPENSSL_LIBDIR
     ])
 
     old_LIBS=$LIBS
-    LIBS="$LIBS -lcrypto"
-    PHP_CHECK_LIBRARY(ssl, SSL_CTX_set_ssl_version, [
+    LIBS="$LIBS -l:libcrypto.a"
+    PHP_CHECK_LIBRARY(:libssl.a, SSL_CTX_set_ssl_version, [
       found_openssl=yes
     ],[
-      AC_MSG_ERROR([libssl not found!])
+      AC_MSG_ERROR([static libssl not found!])
     ],[
       -L$OPENSSL_LIBDIR
     ])
     LIBS=$old_LIBS
-    PHP_ADD_LIBRARY(ssl,,$1)
+    PHP_ADD_LIBRARY(:libcrypto.a,,$1)
+    PHP_ADD_LIBRARY(:libssl.a,,$1)
 
     PHP_ADD_LIBPATH($OPENSSL_LIBDIR, $1)
   fi
