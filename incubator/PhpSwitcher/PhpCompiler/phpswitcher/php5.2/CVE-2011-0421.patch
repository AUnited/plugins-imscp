Index: php-5.2.17/ext/zip/lib/zip_name_locate.c
===================================================================
--- php-5.2.17.orig/ext/zip/lib/zip_name_locate.c	2015-04-13 04:58:08.753313493 +0200
+++ php-5.2.17/ext/zip/lib/zip_name_locate.c	2015-04-13 04:58:48.433312690 +0200
@@ -60,6 +60,10 @@
 	return -1;
     }
 
+    if((flags & ZIP_FL_UNCHANGED)  && !za->cdir) {
+    	return -1;
+    }
+
     cmp = (flags & ZIP_FL_NOCASE) ? strcmpi : strcmp;
 
     n = (flags & ZIP_FL_UNCHANGED) ? za->cdir->nentry : za->nentry;
Index: php-5.2.17/ext/zip/tests/bug53885.phpt
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ php-5.2.17/ext/zip/tests/bug53885.phpt	2015-04-13 04:58:48.433312690 +0200
@@ -0,0 +1,19 @@
+--TEST--
+Bug #53885 (ZipArchive segfault with FL_UNCHANGED on empty archive)
+--SKIPIF--
+<?php
+if(!extension_loaded('zip')) die('skip');
+?>
+--FILE--
+<?php
+$fname = dirname(__FILE__)."/test53885.zip";
+if(file_exists($fname)) unlink($fname);
+touch($fname);
+$nx=new ZipArchive();
+$nx->open($fname);
+$nx->locateName("a",ZIPARCHIVE::FL_UNCHANGED);
+$nx->statName("a",ZIPARCHIVE::FL_UNCHANGED);
+?>
+==DONE==
+--EXPECTF--
+==DONE==
